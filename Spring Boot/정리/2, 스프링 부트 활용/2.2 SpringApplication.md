# SpringApplication 

## 배너

- banner.txt | gif | jpg | png
- classpath 또는 spring.banner.location 로 위치 지정 가능
- ${spring-boot.version} 등의 변수를 사용할 수 있음
- Banner 클래스 구현하고 SpringApplication.setBanner()로 설정 가능

http://patorjk.com/software/taag/#p=display&f=Graffiti&t=Type%20Something%20
https://devops.datenkollektiv.de/banner.txt/index.html

※ war 버전에서 사용 가능한지 확인 필요

## SpringApplicationBuilder

계층관계 Application을 생성해야 하거나 'fluent' builder API를 사용하는 것을 선호한다면 SpringApplicationBuilder를 사용할 수 있다.

SpringApplicationBuilder는 여러 메소드 호출을 연결해서 method chain 할 수있게 하고 

```java
new SpringApplicationBuilder()
               .sources(Parent.class)
               .child(Application.class)
               .bannerMode(Banner.Mode.OFF)
               .run(args);
```


계층관계를 만들수 있는 parent와 child 메소드를 포함하고 있다.

```java
SpringApplicationBuilder appBuilder = new SpringApplicationBuilder()
        .sources(Parent.class);

appBuilder.child(Application1.class).run(args);
appBuilder.child(Application2.class).run(args);
```


## ApplicationEvent

Spring에는 기본적으로 제공하는 이벤트들이 있다.

|Event|실행 시점|순서|비고|
|---|---|---|---|
|ApplicationStartingEvent|Environment 또는 ApplicationContext가 사용 가능하기 전 SpringApplication이 시작되자마자 실행되는 이벤트|1|app.addListeners()|
|ApplicationEnvironmentPreparedEvent|SpringApplication이 시작되고 환경이 처음으로 검사 및 수정할 수 있을 때|2|app.addListeners()|
|ApplicationContextInitializedEvent|SpringApplication이 시작되고 ApplicationContext가 준비되고 ApplicationContextInitializer가 호출되었지만 Bean은 아직 로드되기 전에|3|app.addListeners()|
|ApplicationPreparedEvent|SpringApplication이 시작되고 ApplicationContext가 완전히 준비되었지만 새로 고쳐지지 않은 시점. Bean이 로드된 후이다.|4|app.addListeners()|
|ApplicationStartedEvent|애플리케이션 컨텍스트가 새로 고쳐졌지만 애플리케이션 및 명령 줄 실행기가 호출되기 전에 게시된 이벤트|5|Bean 등록만으로 가능|
|ApplicationReadyEvent|애플리케이션이 요청을 처리할 준비가 되었음을 나타 내기 위해 가능한 한 늦게 게시되는 이벤트|6|Bean 등록만으로 가능|
|ApplicationFailedEvent|시작에 실패할 때|||

<pre>
### ApplicationStartingEvent ###
### ApplicationEnvironmentPreparedEvent ###

 ________     ___    ___             ________  ________ 
|\   __  \   |\  \  /  /|           |\   __  \|\  _____\
\ \  \|\ /_  \ \  \/  / /___________\ \  \|\  \ \  \__/ 
 \ \   __  \  \ \    / /\____________\ \   ____\ \   __\
  \ \  \|\  \  /     \/\|____________|\ \  \___|\ \  \_|
   \ \_______\/  /\   \                \ \__\    \ \__\ 
    \|_______/__/ /\ __\                \|__|     \|__| 
             |__|/ \|__|                                
             
:: Spring Boot :: (v2.4.4)

### ApplicationContextInitializedEvent ###
2021-04-05 06:49:29.508  INFO 174204 --- [  restartedMain] k.s.sample.GradleSampleApplication       : Starting GradleSampleApplication using Java 1.8.0_151 on DESKTOP-HPVS9RB with PID 174204 (D:\99.KYLEE\01.개인프로젝트\59.Study\study\Spring Boot\workspace\GradleSample\bin\main started by kylee in D:\99.KYLEE\01.개인프로젝트\59.Study\study\Spring Boot\workspace\GradleSample)
2021-04-05 06:49:29.511  INFO 174204 --- [  restartedMain] k.s.sample.GradleSampleApplication       : No active profile set, falling back to default profiles: default
2021-04-05 06:49:29.589  INFO 174204 --- [  restartedMain] .e.DevToolsPropertyDefaultsPostProcessor : Devtools property defaults active! Set 'spring.devtools.add-properties' to 'false' to disable
### ApplicationPreparedEvent ###
2021-04-05 06:49:30.300  INFO 174204 --- [  restartedMain] o.s.b.d.a.OptionalLiveReloadServer       : LiveReload server is running on port 35729
2021-04-05 06:49:30.318  INFO 174204 --- [  restartedMain] k.s.sample.GradleSampleApplication       : Started GradleSampleApplication in 1.167 seconds (JVM running for 4.053)
### ApplicationStartedEvent ###
### ApplicationReadyEvent ###
</pre>


### ApplicationEvent 등록

ApplicationContext를 만들기 전에 사용하는 리스너는 @Bean으로 등록할 수 없다.

```java
public static void main(String[] args) {
    SpringApplication app = new SpringApplication(GradleSampleApplication.class);
    app.addListeners(new ApplicationContextInitializedEventListner());
    app.addListeners(new ApplicationEnvironmentPreparedEventListner());
    app.addListeners(new ApplicationFailedEventListner());
    app.addListeners(new ApplicationPreparedEventListner());
    app.addListeners(new ApplicationStartingEventListner());
    app.run(args);
}
```


- WebApplicationType 설정
- 애플리케이션 아규먼트 사용하기

<pre>
    ApplicationArguments를 빈으로 등록해 주니까 가져다 쓰면 됨.
</pre>

- 애플리케이션 실행한 뒤 뭔가 실행하고 싶을 때

<pre>
    ApplicationRunner (추천) 또는 CommandLineRunner
순서 지정 가능 @Order
</pre>



### Spring Boot 공식 참조 문서

> https://docs.spring.io/spring-boot/docs/current/reference/html/boot-features-spring-application.html#boot-features-spring-application